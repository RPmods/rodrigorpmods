<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>RodrigoRPmods Web</title>

  <style>
    :root{
      --bg:#0a0a0a;
      --bg2:#111111;
      --accent:#ff7a1a;       /* naranja oscuro principal */
      --accent-2:#c75a12;     /* naranja más oscuro para hover/bordes */
      --muted:#bfbfbf;
      --text:#eeeeee;
      --card:#151515;
      --card-2:#1b1b1b;
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --grad: radial-gradient(1200px 700px at 0% -10%, rgba(255,122,26,.15), transparent 60%),
              radial-gradient(1000px 600px at 100% 110%, rgba(255,122,26,.10), transparent 60%),
              linear-gradient(180deg, #0b0b0b, #0a0a0a 35%, #0a0a0a);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--text); background: var(--grad), #000;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Inter, Arial, sans-serif;
      line-height:1.4;
    }
    a{text-decoration:none;color:inherit}
    button{font:inherit}

    header{
      position:sticky; top:0; z-index:20;
      background: linear-gradient(90deg, rgba(255,122,26,.12), rgba(255,122,26,.02));
      border-bottom:1px solid rgba(255,255,255,.06);
      padding:14px 18px;
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      backdrop-filter: blur(6px);
    }
    .brand{display:flex; align-items:center; gap:10px; font-weight:800; letter-spacing:.2px;}
    .brand .dot{width:10px; height:10px; border-radius:99px; background:var(--accent); box-shadow:0 0 20px rgba(255,122,26,.55);}
    .title{font-size:1.05rem}
    .tabs{display:flex; gap:8px; align-items:center; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.06); padding:4px; border-radius:12px;}
    .tab{padding:8px 12px; border-radius:10px; cursor:pointer; user-select:none; transition: all .18s ease; color:#ddd;}
    .tab.active{
      background: linear-gradient(180deg, rgba(255,122,26,.22), rgba(255,122,26,.14));
      color:#fff; border:1px solid rgba(255,122,26,.45);
      box-shadow: inset 0 0 0 1px rgba(255,122,26,.15), 0 3px 10px rgba(0,0,0,.25);
    }
    .tab:hover{transform: translateY(-1px);}

    .container{max-width:1200px; margin:18px auto; padding:0 16px; display:grid; grid-template-columns: 300px 1fr; gap:18px;}
    @media (max-width: 980px){ .container{grid-template-columns:1fr} }

    .sidebar{
      background: linear-gradient(180deg, var(--card), var(--card-2));
      border:1px solid rgba(255,255,255,.06);
      border-radius:14px; box-shadow: var(--shadow); overflow:hidden;
    }
    .side-head{
      padding:12px 14px; background:linear-gradient(90deg, rgba(255,122,26,.14), transparent);
      border-bottom:1px solid rgba(255,255,255,.06); display:flex; flex-direction:column; gap:10px;
    }
    .side-head-top{display:flex; justify-content:space-between; align-items:center; gap:6px}
    .side-head .pill{font-size:.8rem; color:#222; background:var(--accent); padding:3px 8px; border-radius:999px; border:1px solid rgba(0,0,0,.15)}

    /* Buscador unificado */
    .search{position:relative; display:flex; align-items:center;}
    .search input{
      width:100%; padding:10px 34px 10px 12px; border-radius:10px; border:1px solid rgba(255,255,255,.08);
      background:rgba(255,255,255,.05); color:#fff; outline:none;
    }
    .search .icon{
      position:absolute; right:10px; width:18px; height:18px; opacity:.8; pointer-events:none;
      background: radial-gradient(circle, rgba(255,255,255,.9) 40%, rgba(255,255,255,.0) 41%);
      -webkit-mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 5 1.5-1.5-5-5zM9.5 14C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>') center/contain no-repeat;
              mask: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="white"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 A6.5 6.5 0 1 0 9.5 16 c1.61 0 3.09-.59 4.23-1.57 l.27.28 v.79 l5 5 1.5-1.5 -5-5 zM9.5 14 C7.01 14 5 11.99 5 9.5 S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14 z"/></svg>') center/contain no-repeat;
    }

    .side-section{padding:10px 10px 14px; border-top:1px dashed rgba(255,255,255,.06);}
    .side-section:first-of-type{border-top:none}
    .side-section h4{margin:10px 6px 8px; font-size:.94rem; color:#ffddc2; letter-spacing:.2px; display:flex; align-items:center; gap:8px; font-weight:700;}
    .side-list{display:flex; flex-direction:column; gap:10px; padding:0 4px}

    .side-item{
      padding:10px; border-radius:12px; background:rgba(255,255,255,.03);
      border:1px solid rgba(255,255,255,.06);
      cursor:pointer; transition:all .15s ease; display:flex; gap:10px; align-items:center;
    }
    .side-item:hover{transform:translateX(2px); background:rgba(255,122,26,.10)}
    .side-item.active{
      background: linear-gradient(180deg, rgba(255,122,26,.24), rgba(255,122,26,.12));
      border-color: rgba(255,122,26,.45);
      box-shadow: inset 0 0 0 1px rgba(255,122,26,.12);
    }
    .side-thumb{
      width:44px; height:44px; border-radius:8px; flex:0 0 44px; background:#222 center/cover no-repeat;
      border:1px solid rgba(255,255,255,.08);
    }
    .side-info{display:flex; flex-direction:column; gap:2px}
    .side-title{font-weight:700;}
    .side-sub{opacity:.75; font-size:.82rem}

    .panel{
      background: linear-gradient(180deg, var(--card), var(--card-2));
      border:1px solid rgba(255,255,255,.06); border-radius:14px; box-shadow: var(--shadow); overflow:hidden;
    }
    .panel-head{
      padding:14px 16px; display:flex; flex-wrap:wrap; gap:10px; align-items:center; justify-content:space-between;
      border-bottom:1px solid rgba(255,255,255,.06);
      background:linear-gradient(90deg, rgba(255,122,26,.08), transparent);
    }
    .crumbs{font-size:.92rem; color:#ffdbc1}
    .badges{display:flex; gap:8px; flex-wrap:wrap}
    .badge{font-size:.78rem; padding:4px 8px; border-radius:999px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08);}
    .badge.primary{ background:rgba(255,122,26,.20); border-color:rgba(255,122,26,.45); color:#ffe4cf; }

    .desc{padding:12px 16px; font-size:.95rem; color:#d8d8d8; border-bottom:1px dashed rgba(255,255,255,.06);}

    .grid{display:grid; gap:14px; padding:14px 14px 18px; grid-template-columns: 1.1fr .9fr;}
    @media (max-width: 980px){ .grid{grid-template-columns:1fr} }

    .chapters{background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.06); border-radius:12px; overflow:hidden;}
    .chap-head{
      padding:12px 14px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      background:linear-gradient(90deg, rgba(255,122,26,.12), transparent);
      border-bottom:1px solid rgba(255,255,255,.06);
      flex-wrap:wrap;
    }
    .chap-title-block{
      display:flex;
      flex-direction:column;
      gap:6px;
    }
    .chap-title-block strong{font-size:.98rem;}
    .lang-switch{
      display:flex;
      gap:6px;
      flex-wrap:wrap;
    }
    .lang-btn{
      font-size:.8rem;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,.12);
      background:rgba(255,255,255,.04);
      cursor:pointer;
      transition:.15s ease all;
      opacity:.85;
    }
    .lang-btn.active{
      background:rgba(255,122,26,.3);
      border-color:rgba(255,122,26,.65);
      opacity:1;
    }
    .chap-list{display:flex; flex-direction:column}
    .chap-item{display:flex; justify-content:space-between; align-items:center; gap:10px; padding:12px 14px; border-top:1px solid rgba(255,255,255,.06); background:transparent; cursor:pointer;}
    .chap-item:hover{background:rgba(255,122,26,.06)}
    .chap-item.active{background:rgba(255,122,26,.14)}
    .tag{font-size:.75rem; padding:2px 6px; border-radius:6px; background:rgba(255,255,255,.06); border:1px solid rgba(255,255,255,.08);}

    .players{background:rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:10px; min-height:320px;}
    .player-buttons{display:flex; flex-wrap:wrap; gap:8px;}
    .btn{border:1px solid rgba(255,255,255,.10); background:rgba(255,255,255,.06); color:#fff; padding:9px 12px; border-radius:10px; cursor:pointer; transition:.15s ease all; font-size:.92rem;}
    .btn:hover{transform:translateY(-1px)}
    .btn.primary{background: linear-gradient(180deg, rgba(255,122,26,.28), rgba(255,122,26,.16)); border-color: rgba(255,122,26,.45);}
    .btn.disabled{background:rgba(255,255,255,.04)!important; border-color:rgba(255,255,255,.06)!important; color:#999!important; cursor:not-allowed!important; filter:grayscale(.6); box-shadow:none!important; transform:none!important;}
    .viewer{margin-top:8px; border-radius:10px; overflow:hidden; border:1px solid rgba(255,255,255,.08); background:#000; aspect-ratio:16/9; display:flex; align-items:center; justify-content:center; color:#999; font-size:.92rem; position:relative;}
    .viewer iframe{width:100%; height:100%; border:0}

    /* Placeholder de portada dentro del visor */
    .cover-ph{
      position:absolute; inset:0;
      background:#000 center/cover no-repeat;
      opacity:0; animation: fadeIn .25s ease forwards;
    }
    .cover-hint{
      position:absolute; bottom:10px; right:10px;
      background:rgba(0,0,0,.45); border:1px solid rgba(255,255,255,.15);
      padding:6px 8px; border-radius:8px; font-size:.85rem; color:#eee;
      opacity:0; animation: fadeIn .25s ease .1s forwards;
    }
    @keyframes fadeIn{ to{opacity:1} }

    .extras{margin:16px 14px 18px; padding:14px; border:1px solid rgba(255,255,255,.06); border-radius:12px; background:rgba(255,255,255,.03);}
    .extras h4{margin:0 0 10px 0}

    /* Mini reproductor MP3 (único) */
    .audio-box{
      display:flex; flex-direction:column; gap:8px; margin-bottom:12px; padding:12px;
      border-radius:10px; background:linear-gradient(180deg, #121212, #0f0f0f); border:1px solid rgba(255,255,255,.08);
    }
    .audio-title{font-weight:700}
    audio{width:100%}

    /* Playlist con imagen */
    .playlist-box{
      display:grid;
      grid-template-columns: 160px 1fr;
      gap:12px;
      margin-bottom:12px; padding:12px;
      border-radius:12px; background:linear-gradient(180deg, #121212, #0f0f0f); border:1px solid rgba(255,255,255,.08);
    }
    @media (max-width:700px){ .playlist-box{grid-template-columns:1fr} }
    .playlist-cover{
      width:100%; aspect-ratio:1/1; border-radius:10px; background:#222 center/cover no-repeat;
      border:1px solid rgba(255,255,255,.08);
    }
    .playlist-body{display:flex; flex-direction:column; gap:8px}
    .playlist-title{font-weight:800}
    .track-list{display:flex; flex-direction:column; gap:6px; max-height:180px; overflow:auto;}
    .track-item{
      display:flex; justify-content:space-between; gap:8px; align-items:center;
      padding:8px 10px; border-radius:8px; background:rgba(255,255,255,.04); border:1px solid rgba(255,255,255,.08);
      cursor:pointer;
    }
    .track-item:hover{background:rgba(255,122,26,.10)}
    .track-item.active{background:rgba(255,122,26,.20); border-color:rgba(255,255,255,.35)}
    .controls{display:flex; gap:8px; flex-wrap:wrap}
    .controls .btn{padding:7px 10px; font-size:.88rem}

    .extra-grid{display:grid; gap:10px; grid-template-columns: repeat(3, 1fr);}
    @media (max-width: 700px){ .extra-grid{grid-template-columns:1fr} }
    .extra-card{background:linear-gradient(180deg, #121212, #0f0f0f); border:1px solid rgba(255,255,255,.06); border-radius:12px; padding:12px; display:flex; flex-direction:column; gap:8px;}
    .extra-card .title{font-weight:700}
    .extra-card .mini{font-size:.85rem; color:#d0d0d0}
    .extra-card .btn{width:100%; text-align:center}

    .placeholder{padding:18px; font-size:1rem; color:#d0d0d0;}
    .note{margin:10px 16px 0; padding:10px 12px; border-radius:10px; background:rgba(25,25,25,.6); border:1px dashed rgba(255,255,255,.10); color:#e9e9e9; font-size:.92rem;}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="dot"></div>
      <div class="title">RodrigoRPmods Web</div>
    </div>
    <nav class="tabs" role="tablist" aria-label="Secciones">
      <div class="tab active" role="tab" aria-selected="true" data-tab="animes">Animes</div>
      <div class="tab" role="tab" aria-selected="false" data-tab="juegos">Juegos</div>
    </nav>
  </header>

  <main id="content">
    <!-- ANIMES -->
    <section id="tab-animes" class="container" aria-labelledby="Animes">
      <!-- Sidebar -->
      <aside class="sidebar" aria-label="Catálogo de animes">
        <div class="side-head">
          <div class="side-head-top">
            <strong>Categorías</strong>
            <span class="pill">Anime BD RPmods / Anime</span>
          </div>

          <!-- Buscador unificado -->
          <div class="search" style="margin-top:8px;">
            <input id="search-all" type="text" placeholder="Buscar en todas las categorías..." />
            <div class="icon"></div>
          </div>
        </div>

        <div class="side-section">
          <h4>Anime BD RPmods <span class="tag">Principal</span></h4>
          <div class="side-list" id="list-bd"></div>
        </div>

        <div class="side-section">
          <h4>Anime <span class="tag">Secundario</span></h4>
          <div class="side-list" id="list-tv"></div>
        </div>
      </aside>

      <!-- Panel principal -->
      <section class="panel" aria-live="polite">
        <div class="panel-head">
          <div class="crumbs" id="breadcrumbs">Selecciona un título en el lado izquierdo</div>
          <div class="badges" id="badges">
            <span class="badge">Audio: —</span>
            <span class="badge">Subtítulos: —</span>
            <span class="badge">OP/ED: —</span>
            <span class="badge">Karaoke: —</span>
            <span class="badge primary">Calidad: —</span>
          </div>
        </div>

        <div class="desc" id="category-note"></div>

        <div class="grid">
          <div class="chapters">
            <div class="chap-head">
              <div class="chap-title-block">
                <strong id="chapters-title">Capítulos</strong>
                <div class="lang-switch">
                  <button class="lang-btn active" id="lang-latino" data-lang="latino">Latino</button>
                  <button class="lang-btn" id="lang-sub" data-lang="sub">Sub Español</button>
                </div>
              </div>
              <span class="tag" id="chapters-lang-label">Latino</span>
            </div>
            <div class="chap-list" id="chapters-list"></div>
          </div>

          <div class="players">
            <div class="player-buttons" id="player-buttons"></div>
            <div class="viewer" id="viewer"><!-- portada placeholder --></div>
          </div>
        </div>

        <!-- Extras -->
        <div class="extras">
          <h4>Contenido extra</h4>

          <!-- Mini reproductor MP3 (único) opcional -->
          <div class="audio-box" id="audio-box" style="display:none">
            <div class="audio-title" id="audio-title">Banda sonora exclusiva</div>
            <audio id="audio-player" controls preload="none">
              <source id="audio-src" src="" type="audio/mpeg">
              Tu navegador no soporta audio HTML5.
            </audio>
            <div class="mini" style="opacity:.8">Puedes usar un <strong>link</strong> (mp3/stream) o una <strong>ruta local</strong>.</div>
          </div>

          <!-- Playlist con imagen -->
          <div class="playlist-box" id="playlist-box" style="display:none">
            <div class="playlist-cover" id="playlist-cover"></div>
            <div class="playlist-body">
              <div class="playlist-title" id="playlist-title">Playlist</div>
              <div class="controls">
                <button class="btn" id="btn-prev">⟨ Anterior</button>
                <button class="btn" id="btn-play">▶ Reproducir</button>
                <button class="btn" id="btn-next">Siguiente ⟩</button>
              </div>
              <div class="track-list" id="track-list"></div>
              <audio id="playlist-audio" preload="none"></audio>
            </div>
          </div>

          <div class="extra-grid" id="extras-grid"></div>
        </div>

        <div class="note">
          Tip: Cualquier botón sin enlace aparecerá en <strong>gris</strong>. Edita enlaces e info en el objeto <code>DATA</code>.
        </div>
      </section>
    </section>

    <!-- JUEGOS -->
    <section id="tab-juegos" class="container" style="display:none" aria-labelledby="Juegos">
      <section class="panel" style="grid-column:1/-1">
        <div class="panel-head">
          <div class="crumbs">Juegos</div>
          <div class="badges"><span class="badge">Próximamente</span></div>
        </div>
        <div class="placeholder">
          Esta sección está preparada para tus juegos. Puedes reutilizar el estilo de <em>Animes</em>.
        </div>
      </section>
    </section>
  </main>

  <script>
    /* ===========================
       DATASET EDITABLE
       =========================== */
    const DATA = {
      bd: {
        "Las Quintillizas (Temporada 1)": {
          cover: "portada/portadas1gnh.jpg",
          openingUrl: "",   // Opening propio
          endingUrl: "",    // Ending propio
          info: {
            audio: "Latino / Japonés",
            subs: "Latino",
            oped: "Clean Version (BD RPmods)",
            karaoke: "Sí",
            quality: "1080p (BD)",
            note: "Edición Blu-ray con mejoras de imagen, audio y extras exclusivos."
          },
          chapters: {
            latino: [
              { id:"gtn-t1-lat-prox1", title:"Próximamente — Capítulos 01 y 02", info:"Audio Latino — Esperando estreno", status:"Próximo",
                players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"gtn-t1-lat-prox2", title:"Próximamente — Capítulos 03 y 04", info:"Audio Latino — Esperando estreno", status:"Próximo",
                players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"gtn-t1-lat-prox3", title:"Próximamente — Capítulos 05 y 06", info:"Audio Latino — Esperando estreno", status:"Próximo",
                players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } }
            ],
            sub: [
              { id:"gtn-t1-sub-c01-02", title:"Capítulo 01 y 02", info:"Sub Español — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#assgjc", player2:"", fb:"", fb720:"", player3:"https://www.burstcloud.co/embed/e26685e0e94c3f13648e0fa29968af01af467c43f2e8cfe1e15f15905fbfddeb/GNH_CAP01RPMODS.mp4" } },
              { id:"gtn-t1-sub-c03-04", title:"Capítulo 03 y 04", info:"Sub Español — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#qyy5ic", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"gtn-t1-sub-prox1", title:"Próximamente — Capítulos 05 y 06", info:"Sub Español — Esperando estreno", status:"Próximo",
                players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } }
            ]
          },
          extrasAudio: { title: "OST — Quintillizas", url: "" },
          extras: [
            { id:"gtn-extra-1", title:"Extra 01 — Entrevista Seiyuu", url:"" },
            { id:"gtn-extra-2", title:"Extra 02 — Clean OP (BD)", url:"" },
            { id:"gtn-extra-3", title:"Extra 03 — Clean ED (BD)", url:"" }
          ],
          extrasPlaylist: {
            cover:"extra/cover_quintillizas_t1.jpg",
            title:"Playlist — Quintillizas T1",
            tracks: []
          }
        },
        "KonoSuba (Temporada 1)": {
          cover: "portada/portadas1fk.png",
          openingUrl: "https://www.burstcloud.co/embed/67a4691f55a6d1fe64dc1e1b6f67ba290af75cf63c59a84a2d02de0e7cbecefe/Opening.mp4",  // ejemplo
          endingUrl: "https://www.burstcloud.co/embed/1c16c761c9fbc8d957132e51116d96aea716a255ece139a88225d5f95a6a0cd9/Edning%20%20Full%20Version.mp4",
          info: {
            audio: "Japonés",
            subs: "Español (SUB)",
            oped: "Clean Version",
            karaoke: "Sí",
            quality: "1080p (BD RPmods)",
            note: "Edición Blu-ray con timing de karaoke y filtros de imagen."
          },
          chapters: {
            latino: [
              { id:"ksb-t1-lat-c01-02", title:"Capítulo 01 y 02", info:"Audio Latino — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#8kqexi", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"ksb-t1-lat-c03-04", title:"Capítulo 03 y 04", info:"Audio Latino — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#61wy1p", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"ksb-t1-lat-c05-06", title:"Capítulo 05 y 06", info:"Audio Latino — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#qyx9cu", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"ksb-t1-lat-c07-08", title:"Capítulo 07 y 08", info:"Audio Latino — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#gwdze9", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"ksb-t1-lat-c09-10-11", title:"Capítulo 09 - 10 y 11 (OVA)", info:"Audio Latino — BD RPmods 1080p",
                players:{ player1:"https://rodrigorpmods.rpmlive.online/#xuakg9", player2:"", fb:"", fb720:"", player3:"" } }
            ],
            sub: [
              { id:"ksb-t1-sub-c01-02", title:"Capítulo 01", info:"Sub Español — BD RPmods 1080p",
                players:{ player1:"https://www.burstcloud.co/embed/8bba8c60b5711fc8e4b2b8c8ab0fdab782e684b8588bcd18e89baa0f62271430/capitulo%2001%20version%20jap%C3%83%C2%B3nes%20completo%20BD.mp4", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"ksb-t1-sub-prox1", title:"Próximamente — Capítulo 02", info:"Sub Español — Esperando estreno", status:"Próximo",
                players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"ksb-t1-sub-prox2", title:"Próximamente — Capítulo 03", info:"Sub Español — Esperando estreno", status:"Próximo",
                players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } }
            ]
          },
          extrasAudio: { title: "Radio KonoSuba — Selección", url: "" },
          extras: [
            { id:"ksb-extra-1", title:"Konosuba Opening Japonés (BD RPmods)", url:"https://www.burstcloud.co/embed/a016efb21b954af2e08cd8759cf69363274aa577b3de20ea0e362251c6c977a0/Version%20OP%20clean%20solo.mp4" },
            { id:"ksb-extra-1", title:"Konosuba Ending Japonés (Aqua y Kazuma ARC Ver. BD RPmods)", url:"https://www.burstcloud.co/embed/3231e849fe3142dc8ee4092e84f939d7a31e894c632855c11537e798944f60e3/Version%20ED%20clean%20solo.mp4" },
            { id:"ksb-extra-1", title:"Konosuba Opening (JAPONÉS) (Crunchyroll)", url:"https://www.youtube.com/watch?v=fpG3BPNQepY" },
            { id:"ksb-extra-2", title:"Konosuba Ending (JAPONÉS) (Crunchyroll)", url:"https://www.youtube.com/watch?v=JhiU4IAZtug" }
          ],
          extrasPlaylist: {
            cover: "extra/CB_COVER.png",
            title: "Chiisana Boukensha — Colección Ending S1 (Japonés)",
            tracks: [
              { src: "extra/01CB.mp3",   title: "Chiisana Boukensha Ending Version Full" },
              { src: "extra/02CBAV.mp3", title: "Chiisana Boukensha Aqua Version Full" },
              { src: "extra/03CBM.mp3",  title: "Chiisana Boukensha Megumin Version Full" },
              { src: "extra/04CBD.mp3",  title: "Chiisana Boukensha Darkness Version Full" },
              { src: "extra/05CBI.mp3",  title: "Chiisana Boukensha (Instrumental)" }
            ]
          }
        }
      },
      tv: {
        "Las 100 Novias": {
          cover: "",
          info: {
            audio: "Japonés",
            subs: "Español (SUB)",
            oped: "Versión TV",
            karaoke: "No",
            quality: "1080p",
            note: "Edición estándar para streaming."
          },
          chapters: {
            latino: [
              { id:"100nv-lat-prox0", title:"Próximamente — Capítulos 01 y 02", info:"Latino — Esperando estreno", status:"Próximo", players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"100nv-lat-prox1", title:"Próximamente — Capítulos 03 y 04", info:"Latino — Esperando estreno", status:"Próximo", players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"100nv-lat-prox2", title:"Próximamente — Capítulos 05 y 06", info:"Latino — Esperando estreno", status:"Próximo", players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } }
            ],
            sub: [
              { id:"100nv-sub-prox0", title:"Próximamente — Capítulos 01 y 02", info:"Sub Español — Esperando estreno", status:"Próximo", players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"100nv-sub-prox1", title:"Próximamente — Capítulos 03 y 04", info:"Sub Español — Esperando estreno", status:"Próximo", players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } },
              { id:"100nv-sub-prox2", title:"Próximamente — Capítulos 05 y 06", info:"Sub Español — Esperando estreno", status:"Próximo", players:{ player1:"", player2:"", fb:"", fb720:"", player3:"" } }
            ]
          },
          extrasAudio: { title: "OST — 100 Novias", url: "" },
          extras: [
            { id:"100nv-extra-1", title:"Extra 01 — PV #1", url:"" },
            { id:"100nv-extra-2", title:"Extra 02 — PV #2", url:"" },
            { id:"100nv-extra-3", title:"Extra 03 — OST Preview", url:"" }
          ],
          extrasPlaylist: { cover:"extra/cover_100novias.jpg", title:"Playlist — 100 Novias", tracks: [] }
        }
      }
    };

    /* ===========================
       UTILIDADES UI
       =========================== */
    const $  = sel => document.querySelector(sel);
    const $$ = sel => Array.from(document.querySelectorAll(sel));

    const tabButtons = $$('.tab');
    const tabAnimes  = $('#tab-animes');
    const tabJuegos  = $('#tab-juegos');

    tabButtons.forEach(btn=>{
      btn.addEventListener('click', ()=>{
        tabButtons.forEach(b=>b.classList.remove('active'));
        btn.classList.add('active');
        const id = btn.dataset.tab;
        if(id==='animes'){ tabAnimes.style.display='grid'; tabJuegos.style.display='none'; }
        else { tabAnimes.style.display='none'; tabJuegos.style.display='grid'; }
      });
    });

    // Estado
    let currentScope = 'bd';
    let currentAnimeKey = null;
    let currentChapterId = null;
    let currentLang = 'latino';

    // Elementos dinámicos
    const listBD = $('#list-bd');
    const listTV = $('#list-tv');
    const searchAll = $('#search-all');

    const crumbs = $('#breadcrumbs');
    const badges = $('#badges');
    const categoryNote = $('#category-note');

    const chaptersTitle = $('#chapters-title');
    const chaptersList = $('#chapters-list');
    const playerButtonsWrap = $('#player-buttons');
    const viewer = $('#viewer');
    const extrasGrid = document.querySelector('#extras-grid');

    // Audio único (opcional)
    const audioBox = $('#audio-box');
    const audioTitle = $('#audio-title');
    const audioPlayer = $('#audio-player');
    const audioSrc = $('#audio-src');

    // Playlist UI
    const playlistBox = $('#playlist-box');
    const playlistCover = $('#playlist-cover');
    const playlistTitle = $('#playlist-title');
    const trackList = $('#track-list');
    const btnPrev = $('#btn-prev');
    const btnPlay = $('#btn-play');
    const btnNext = $('#btn-next');
    const playlistAudio = $('#playlist-audio');

    // Botones idioma capítulos
    const langLatBtn = $('#lang-latino');
    const langSubBtn = $('#lang-sub');
    const chaptersLangLabel = $('#chapters-lang-label');

    /* Cambiar idioma (Latino / Sub) */
    function setLang(lang){
      if(lang !== 'latino' && lang !== 'sub') return;
      currentLang = lang;

      langLatBtn.classList.toggle('active', lang === 'latino');
      langSubBtn.classList.toggle('active', lang === 'sub');
      chaptersLangLabel.textContent = (lang === 'latino') ? 'Latino' : 'Sub Español';

      if(currentScope && currentAnimeKey){
        setChapters(currentScope, currentAnimeKey);
        currentChapterId = null;
        playerButtonsWrap.innerHTML = '';
        resetViewer(); // mantiene portada
      }
    }

    langLatBtn.addEventListener('click', ()=> setLang('latino'));
    langSubBtn.addEventListener('click', ()=> setLang('sub'));

    /* Render Sidebar con filtro unificado */
    function renderSidebar(filter = ""){
      listBD.innerHTML = '';
      listTV.innerHTML = '';

      Object.keys(DATA.bd)
        .filter(k => k.toLowerCase().includes(filter.toLowerCase()))
        .forEach(key => listBD.appendChild(createSideItem('bd', key, 'BD RPmods')));

      Object.keys(DATA.tv)
        .filter(k => k.toLowerCase().includes(filter.toLowerCase()))
        .forEach(key => listTV.appendChild(createSideItem('tv', key, 'Anime')));

      const active = $(`.side-item[data-scope="${currentScope}"][data-key="${CSS.escape(currentAnimeKey||'')}"]`);
      if(active) active.classList.add('active');
    }

    function createSideItem(scope, key, catLabel){
      const item = document.createElement('div');
      item.className = 'side-item';
      item.dataset.scope = scope;
      item.dataset.key = key;

      const cover = (DATA[scope][key].cover || "").trim();

      item.innerHTML = `
        <div class="side-thumb" style="${cover ? `background-image:url('${cover}')` : ''}"></div>
        <div class="side-info">
          <div class="side-title">${key}</div>
          <div class="side-sub">${catLabel}</div>
        </div>
      `;
      item.addEventListener('click', ()=>{
        $$('.side-item').forEach(i=>i.classList.remove('active'));
        item.classList.add('active');
        selectSeries(scope, key);
      });
      return item;
    }

    function selectSeries(scope, key){
      currentScope = scope;
      currentAnimeKey = key;
      currentChapterId = null;

      const info = DATA[scope][key].info;

      setCrumbs(scope, key);
      setBadges(info);
      setChapters(scope, key);
      setExtras(scope, key);
      setCategoryText(scope, key);
      resetViewer(); // portada placeholder
    }

    /* Texto por categoría */
    function setCategoryText(scope, key){
      const baseText = scope==='bd'
        ? `<strong>Anime BD RPmods:</strong> versiones Blu-ray mejoradas con añadidos especiales.`
        : `<strong>Anime:</strong> ediciones estándar para streaming.`;

      categoryNote.innerHTML = baseText;
    }

    function setCrumbs(scope, key){
      const scopeTxt = scope==='bd' ? 'Anime BD RPmods' : 'Anime';
      crumbs.textContent = `${scopeTxt} / ${key}`;
    }

    function setBadges(info){
      badges.innerHTML = '';
      const mk = (txt, primary=false)=>{
        const s = document.createElement('span');
        s.className = 'badge' + (primary?' primary':'');
        s.textContent = txt; return s;
      };
      badges.appendChild(mk(`Audio: ${info.audio || '—'}`));
      badges.appendChild(mk(`Subtítulos: ${info.subs || '—'}`));
      badges.appendChild(mk(`OP/ED: ${info.oped || '—'}`));
      badges.appendChild(mk(`Karaoke: ${info.karaoke || '—'}`));
      badges.appendChild(mk(`Calidad: ${info.quality || '—'}`, true));
    }

    function setChapters(scope, key){
      const series = DATA[scope][key];
      chaptersTitle.textContent = `Capítulos — ${key}`;
      chaptersList.innerHTML = '';

      let list = [];
      if(Array.isArray(series.chapters)){
        list = series.chapters;
      }else if(series.chapters && Array.isArray(series.chapters[currentLang])){
        list = series.chapters[currentLang];
      }

      if(!list.length){
        const row = document.createElement('div');
        row.className = 'chap-item';
        row.innerHTML = `
          <div><strong>Sin capítulos en este idioma</strong></div>
          <span class="tag">Próximamente</span>
        `;
        chaptersList.appendChild(row);
        return;
      }

      list.forEach((ch)=>{
        const row = document.createElement('div');
        row.className = 'chap-item';
        row.dataset.id = ch.id;
        row.innerHTML = `
          <div>
            <div><strong>${ch.title}</strong></div>
            <div class="small" style="opacity:.8">${ch.info || ''}</div>
          </div>
          <span class="tag">${ch.status ? ch.status : 'Disponible'}</span>
        `;
        row.addEventListener('click', ()=>{
          $$('.chap-item').forEach(i=>i.classList.remove('active'));
          row.classList.add('active');
          currentChapterId = ch.id;
          renderPlayerButtons(ch.players);
          resetViewer(true);
        });
        chaptersList.appendChild(row);
      });
    }

    function renderPlayerButtons(players){
      playerButtonsWrap.innerHTML = '';
      const defs = [
        { key:'player1', label:'Reproductor 1' },
        { key:'player2', label:'Reproductor 2' },
        { key:'fb',     label:'Ver en Facebook' },
        { key:'fb720',  label:'Reproductor Facebook 720p' },
        { key:'player3',label:'Reproductor 3' },
      ];

      defs.forEach(def=>{
        const url = (players && players[def.key]) ? players[def.key] : '';
        const btn = document.createElement('button');
        btn.className = 'btn ' + (url ? 'primary' : 'disabled');
        if(!url) btn.setAttribute('disabled','');
        btn.textContent = url ? def.label : `${def.label} (sin link)`;
        btn.dataset.url = url || '';
        btn.addEventListener('click', (e)=>{
          const u = e.currentTarget.dataset.url;
          if(!u) return;
          // "Ver en Facebook" abre nueva pestaña
          if(def.key === 'fb'){
            window.open(u, '_blank');
          }else{
            openInViewer(u);
          }
        });
        playerButtonsWrap.appendChild(btn);
      });
    }

    /* ====== EXTRAS ====== */
    function setExtras(scope, key){
      const series = DATA[scope][key];

      // Audio único
      if(series.extrasAudio && series.extrasAudio.url){
        audioBox.style.display = 'flex';
        audioTitle.textContent = series.extrasAudio.title || 'Banda sonora';
        audioSrc.src = series.extrasAudio.url;
        audioPlayer.load();
      }else{
        audioBox.style.display = 'none';
        audioSrc.src = '';
        audioPlayer.pause();
      }

      // Playlist:
      const pl = series.extrasPlaylist;
      const isBD = (scope === 'bd');

      if(isBD){
        renderPlaylist(`${scope}|${key}`, pl || { cover:'', title:'Playlist', tracks: [] }, { forceShow:true });
      }else{
        if(pl && Array.isArray(pl.tracks) && pl.tracks.length){
          renderPlaylist(`${scope}|${key}`, pl, { forceShow:false });
        }else{
          playlistBox.style.display = 'none';
          trackList.innerHTML = '';
          playlistAudio.pause();
        }
      }

      // Tarjetas extra (todas en NUEVA pestaña)
      extrasGrid.innerHTML = '';

      let extrasToRender = [];

      if(isBD){
        // Opening/Ending por serie
        extrasToRender.push(
          { id:"opening", title:"Opening Latino Clean Version", url: series.openingUrl || "" },
          { id:"ending",  title:"Ending Latino Clean Version",  url: series.endingUrl  || "" }
        );
      }

      // + extras propios
      (series.extras || []).forEach(ex => extrasToRender.push(ex));

      extrasToRender.forEach((ex)=>{
        const card = document.createElement('div');
        card.className = 'extra-card';
        const hasUrl = !!(ex.url && ex.url.trim());
        card.innerHTML = `
          <div class="title">${ex.title}</div>
          <div class="mini">Material exclusivo o adicional.</div>
          <button class="btn ${!hasUrl ? 'disabled' : 'primary'}" ${!hasUrl ? 'disabled':''}
                  data-url="${hasUrl ? ex.url : ''}">
            ${hasUrl ? 'Abrir en nueva pestaña' : 'Sin enlace'}
          </button>
        `;
        card.querySelector('button').addEventListener('click', (e)=>{
          const url = e.currentTarget.dataset.url;
          if(!url) return;
          window.open(url, '_blank');
        });
        extrasGrid.appendChild(card);
      });
    }

    function renderPlaylist(stateKey, pl, opts = { forceShow:false }){
      playlistBox.style.display = 'grid';
      playlistTitle.textContent = pl.title || 'Playlist';
      playlistCover.style.backgroundImage =
        (pl.cover && pl.cover.trim()) ? `url('${pl.cover}')` : 'linear-gradient(135deg, #1d1d1d, #0f0f0f)';

      if(!renderPlaylist.state) renderPlaylist.state = {};
      if(!renderPlaylist.state[stateKey]) renderPlaylist.state[stateKey] = { index:0, playing:false };
      const state = renderPlaylist.state[stateKey];

      const tracks = Array.isArray(pl.tracks) ? pl.tracks : [];
      trackList.innerHTML = '';

      if(tracks.length === 0){
        const empty = document.createElement('div');
        empty.className = 'track-item';
        empty.innerHTML = `<div>Sin pistas por ahora</div><span class="tag">Próximamente</span>`;
        trackList.appendChild(empty);
        btnPrev.disabled = true; btnNext.disabled = true;
        btnPrev.classList.add('disabled'); btnNext.classList.add('disabled');
        btnPlay.textContent = '▶ Reproducir';
        btnPlay.onclick = ()=>{};
        playlistAudio.pause();
        playlistAudio.removeAttribute('src');
        return;
      }

      btnPrev.disabled = false; btnNext.disabled = false;
      btnPrev.classList.remove('disabled'); btnNext.classList.remove('disabled');

      tracks.forEach((t, i)=>{
        const li = document.createElement('div');
        li.className = 'track-item' + (i===state.index && state.playing ? ' active' : '');
        li.dataset.index = i;
        li.innerHTML = `<div>${t.title || ('Pista '+(i+1))}</div><span class="tag">${i===state.index && state.playing ? 'En curso' : 'Reproducir'}</span>`;
        li.addEventListener('click', ()=>{
          state.index = i; state.playing = true;
          loadAndPlay({ tracks }, state);
          refreshTrackList({ tracks }, state);
        });
        trackList.appendChild(li);
      });

      btnPrev.onclick = ()=>{
        state.index = (state.index - 1 + tracks.length) % tracks.length;
        state.playing = true;
        loadAndPlay({ tracks }, state);
        refreshTrackList({ tracks }, state);
      };
      btnNext.onclick = ()=>{
        state.index = (state.index + 1) % tracks.length;
        state.playing = true;
        loadAndPlay({ tracks }, state);
        refreshTrackList({ tracks }, state);
      };
      btnPlay.onclick = ()=>{
        if(state.playing){
          playlistAudio.pause(); state.playing = false; btnPlay.textContent = '▶ Reproducir';
        }else{
          if(!playlistAudio.src) loadAndPlay({ tracks }, state); else playlistAudio.play();
          state.playing = true; btnPlay.textContent = '⏸ Pausar';
        }
        refreshTrackList({ tracks }, state);
      };

      playlistAudio.onended = ()=>{
        state.index = (state.index + 1) % tracks.length;
        state.playing = true;
        loadAndPlay({ tracks }, state);
        refreshTrackList({ tracks }, state);
      };

      if(!playlistAudio.src && tracks.length){
        loadTrack({ tracks }, state);
        btnPlay.textContent = '▶ Reproducir';
      }
      refreshTrackList({ tracks }, state);
    }

    function loadTrack(pl, state){
      const track = pl.tracks[state.index];
      playlistAudio.src = track.src || '';
    }
    function loadAndPlay(pl, state){
      loadTrack(pl, state);
      playlistAudio.play().catch(()=>{ /* autoplay bloqueado */ });
      btnPlay.textContent = '⏸ Pausar';
    }
    function refreshTrackList(pl, state){
      $$('#track-list .track-item').forEach((el, i)=>{
        const active = (i===state.index && state.playing);
        el.classList.toggle('active', active);
        const tag = el.querySelector('.tag');
        if(tag) tag.textContent = active ? 'En curso' : 'Reproducir';
      });
    }

    /* ========= Visor ========= */
    function resetViewer(showHint=false){
      const cover = (DATA[currentScope][currentAnimeKey]?.cover || "").trim();
      viewer.innerHTML = '';
      if(cover){
        const ph = document.createElement('div');
        ph.className = 'cover-ph';
        ph.style.backgroundImage = `url('${cover}')`;
        viewer.appendChild(ph);
      }
      const hint = document.createElement('div');
      hint.className = 'cover-hint';
      hint.textContent = showHint ? 'Elige un reproductor para cargar el video aquí' : 'Selecciona un capítulo y un reproductor';
      viewer.appendChild(hint);
    }

    function openInViewer(url){
      if(!url) return;
      viewer.innerHTML = `<iframe allow="autoplay; fullscreen" src="${url}"></iframe>`;
    }

    // Filtro unificado
    searchAll.addEventListener('input', ()=> renderSidebar(searchAll.value));

    // Inicialización
    renderSidebar();
    const firstBD = listBD.querySelector('.side-item');
    if(firstBD){ firstBD.click(); }
  </script>
</body>

</html>
